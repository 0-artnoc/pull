language: node_js
node_js:
  - node
env:
  global:
    - secure: lrqIuzoJjZHVQLev7hMkT4KohoFMg0DoobMJsdLertix5FPwoqJpWZXpWPswZKnQrPaOB6dvJ6fhQ1kouCHt2DpB+gdE8SdIKpfotEZO89no1R+sDCJOZRVJ83uLKX8+tpzzD/jXPyqce5qRE/JGvlwSZLGyYu9l+syzr1hVj44p7UARuC5mA+OMLPw+V1OPz0ayL0+4WoGEjBFUJzsEnNNEnSbGzRQVIouKL2/k+cVgAAqiMqwne4NT+YmRQGFKNyC+ZREV42TWb5as+5fxlvixLlL0olzIxZSuE0JgnHeVNlihCcnGiom/8P6Zi9Kc0AauUX5UVw5oKZtqlou6S3p4yAjbm+6U72ErQpt8yKmSDxzcJBOluPSeFd56d2Z4dNQaEspMGv2OzvyuUXUARcLxgIaOqaVjrz9uhsaq5w/hCSu+Gy4GS+NNXtRYSzgin9rxH2iW6XYr6B7qByNGC5ozsgSP0MyWi7ChMhQI4WktKpoBNiUsHvrbUFyJSJk72LUCzwX1Fcx1tqoUKpJ8ST35WQ33WqoWmFMDe7OKKngBfaxwaBfGywTr9LtKjwg6jgZgVCIzmHOyk76ZYtWQLBeyMNsHULhnENGv4IrYba8AkhTcNjTaShG5nkmUCcdAWNjyUHMavTUA1+klBhb82WG/Eq2LYK/24cD3dutkw2g=
    - secure: hN52EtCBBtEnRYgvPDzD1nrZBwOCmrHyt7hl6WCwGSzEExnXzi9NdEMLZkhMRJmdqVrO4/YsDDFsOl8X5fHII5WNV5r7CVRK4eT8aOcshdjQ+NhO+DFJDx1sBs+bOGg4Np7Jtl3/gQv7WeeKZtgK3ThzlvDJPnbzfiNc3XxxF/ld6M0r1cEUU/qGoWVNQ5KioI0m4nxgFEGGEXSX4iY3OanTIRBUjaldmfLVEcixMuGRy0lISZH5D+v8Nln6TZt9D1xPJ77MNtVIiKdrXBmBzYfbxQFVDll75hg+SbHfDSHxUtAcUOnLVWzVA0wseCCyw8UZXD/GXo3PlAncgb7i8p9r/+3LGR3E5/KNNYODc7jQ1WNIDl7Z/nl+eEcYA1rcw/t6rHXYMWW3qLjxTukxpwEfbPvAKy2ewP2F318SKDzp5bmPw0ghbpQSWSTp/iH4MfZQyUCLDoa8wc3drf4aUlY52I5D9RRwIWuxMqBveRUC7LQYXV6aKWzKhQsy/YZa4ZlSMWU5u77qjIr98NqwdSXzxyl5b7sjOomIHTayh9Ddlns3yjpCVTQbx9RmpcPfcI1I6qDNmUdi3wYjmLX2Xayb/wqOinghVX2sK4rgs/ik8F0R83fF32AKa7BxaaokJXN8P8xuUrIr+85OPftwasHgvTxrBbXUUv8+NXl2lvc=
    - secure: lF59R0pIEJr8rq++YzKVNl4hGT6pF3vsQwa4CZY8h9HQDq8nAl2RJbdPma3+/6U0qdYZ3wtLEd1pwC4SMXGYSLCHfPScdIDZRAl16pe8rvHdYTFtcqp2TV846vuLWg9bf7sfSK4cddC2PKRx6qkmSVKjZR/CQhTMo0Rjd35zlHYvxpMS5vCXrfukj9LEKcCWwtBKINkOoee0KLrM+oOSH1SLw1QE0rLzZp81ce51IscmCc2go0vUMwNQccq9OmxsQJVBZZpojQhbcx/Fnj0RcL4qkUvfTW87LqlXOwov5wf8OEONNvczWKF1oKD6S4DxKQBU3g25pkSMch5VFttvLU5LcZyHrubVlfH5J6jfVptgfCPx99jY4NGMCp8CcaiRvSTEu51EHZRR+k4JWZrOhhSMCSymyH0oSYt+OjlKDMKdIEM3ho8ZcylqXtgCkJAgFLy6U7KhkSinh47khIMSPViIVylqwFByodvoUwKL6rKAoIUfgCBylJk6V9B8yyi0fN6CllDG9xqzT4O+8C9q/bymW/qYNVTaGUBv76HNhwKnTLRAT+EnqdiCh4//6vAke7CEdHEO5dhB8A4FySfdHZU7nkxdPIgWLPb7b+ltOtTY4lUSg8yuAAtdL311XT6vg4S6aS0Nfp/BhJwAVcn4W9TeOf8aQVAZoTTc01sVrlE=
    - secure: ITzlaa3ZiEq8L6m1hWV9boJwzoTnOmA0N8mce3JHv722+EUud26/uLn6Nz9emytMN3HoSyvmbG34YcaYNUT2ek+jE6aoSHApEIvr54CNLETqpMcZ6HqKhyYA6hdvKE3/s3drXy6h4Z38amaDnk0wEqbp+k8QiS0qt7CNEAhGO7ZR++0EiASTnCnOw48Rcvrmv4XLJ5Rcm4d2XGAXzRHwzCEuOK7nHSlhZczv7HCAH7aSpuEpu5EtbrB3tl2oTMicVhA37tebxVDRR/Gg0MnCTdLFnjFvTcy5Sn9IOq51su5gX+AtXw1KDRG6u52NSVvH7fmZOGSfzT9kdGXLgDyGU4YGtZvvfMWOcvJe3j2R6BHz4zAzzK9klXEU8ye1X5AgA47SMT+wFj7RSpJeCI6E/98ogceFbnBhW0Qcfk1CYbY1fwWrzU3oQOpQX/rU3rM0XTd8I6H/OexdHBV8LGUgaVUhjsOs64T8NdakXiN7UwELx/4FUgE7WpBaltJjNQGmKg66p1q8JbEmPSWhbqIUBGpjLMMg0IF9NKjOZgkfhhDcXOFl5WURmEx/XEzYmbzmx63Vh4954yVP5+Z6/rF2kO8HdoRnJDuUZuz/n5slzIPRA6P7Mcv3LZ88dKqUWhuQjLI75lcqEefJ2F66u1KSz5Sm8qKVQt10Fv7yf9jsUjU=
    - secure: D6HR4KvD4r4PLlqgk7zGlVe8UAzHoGMCud1VEWuZNYKIaZ5/fgAp3pcwG2jbBKURGBcKI80rLX05OR8CYUK2/aQE8vyZuDhv3hUz5O/KC3fllXHy9XZ9nCOz8sSGkhOcaM6jaM7yZVSzT8bpnySyHQO8XVrlO9odgy2iIvBUa2IzLSa8Q2ya0etF3GL9v1/ZNarjjufULmQX0V0ChIbF4B5uA6wC0zkdyBcyaJpEyzWH0Jz2aAl0Z9KMT4IKXcXWfdltqtSefmxuhku7KW3A+RhVnax/5NWVU4jBaUG73iZpTMPSQdwlxTw3u1JvFgj6isGxJU12japNdT5zIt/mlMPc7w5/l7mlzvtVwcDoI7RL8JuMGwuJvUxoWtwtsZE/GBxQ2wt9xQ8StRWIbRzFndrLqbJi2T4+9ezB6r4Do3/TEd0vPWbvH36hgiKN/85CjnPZ5ziFNmG3Jx4GEc/+eLQ1bieKfgSBlNOEDiMbF1YEmFrmrXfWWJVBKy3Wd9VukuNU/E2YRjyN5u+8OPXXKlev3ui9PXOQEmH4KAJ2v9QlriJxNIs4/aQOo6YAYdWytFnRCMmVa46sU+mGQ6ExCB+LUt9YkaOXG4iDf5SuxVdn+ziTRHx7xk+I5pr+ZtGebEXTlcKnDiPG+I854J4l0HYnjCAmMCmlHy/m9LiCYZI=
cache:
  directories:
    - node_modules
    - $(npm config get prefix)/lib/node_modules
install:
  - npm i
script:
  - npm test
branches:
  only:
    - master
    - /^feature-.*/
after_success:
  - npm i codecov -g && codecov
before_deploy:
  - export NOW_ALIAS=pull
  - export PRIVATE_BASE64=$(openssl aes-256-cbc -K $encrypted_c408d5c1e9ea_key -iv $encrypted_c408d5c1e9ea_iv -in pk.pem.enc -d | base64)
  - npm i now -g
deploy:
  provider: script
  script: npm run travis:deploy-now
  on:
    branch: master
